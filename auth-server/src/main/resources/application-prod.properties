spring.threads.virtual.enabled=${ENABLE_VIRTUAL_THREAD:true}

server.port=${SERVER_PORT:8080}

logging.config=${LOGGING_CONFIG:classpath:logback.xml}

spring.application.name=auth-server
spring.jackson.default-property-inclusion=non_null
spring.messages.basename=i18n/messages
spring.messages.encoding=UTF-8

spring.datasource.dynamic.primary=master
spring.datasource.dynamic.datasource.master.driver-class-name=${multi.tenant.db.driver-class-name}
spring.datasource.dynamic.datasource.master.url=${multi.tenant.db.base-url}${multi.tenant.db-prefix}${multi.tenant.default-tenant}
spring.datasource.dynamic.datasource.master.username=${multi.tenant.db.username}
spring.datasource.dynamic.datasource.master.password=${multi.tenant.db.password}

# \u7981\u7528\u4E8C\u7EA7\u7F13\u5B58
mybatis-plus.configuration.cache-enabled=false
# \u8BBE\u7F6E\u4E00\u7EA7\u7F13\u5B58\u7EA7\u522B\u4E3A statement
mybatis-plus.configuration.local-cache-scope=statement

spring.data.redis.host=${REDIS_HOST}
spring.data.redis.port=${REDIS_PORT}
spring.data.redis.password=${REDIS_PASSWORD}
spring.data.redis.lettuce.pool.enabled=true
spring.data.redis.lettuce.pool.max-active=100

spring.flyway.enabled=${FLYWAY_ENABLED:true}
spring.flyway.clean-disabled=${FLYWAY_CLEAN_DISABLED:true}
spring.flyway.locations=classpath:flyway/postgre/master
spring.flyway.baseline-on-migrate=${FLYWAY_BASELINE_ON_MIGRATE:true}
spring.flyway.placeholder-prefix=$${
spring.flyway.placeholder-suffix=}$$
spring.flyway.placeholders.consoleRedirectUrl=${auth.server.default-console-url}${auth.server.console-redirect-path}

springdoc.api-docs.enabled=${API_DOC_ENABLED:false}
springdoc.api-docs.path=/docs
springdoc.swagger-ui.enabled=${SWAGGER_UI_ENABLED:false}
springdoc.group-configs[0].group=all
springdoc.group-configs[0].paths-to-match=/**
springdoc.group-configs[0].paths-to-exclude=/error

auth.server.api-prefix=${API_PREFIX:/api/v1}
auth.server.default-issuer=${DEFAULT_ISSUER}
auth.server.default-console-url=${DEFAULT_CONSOLE_URL}
auth.server.console-redirect-path=${CONSOLE_REDIRECT_PATH:/ui/oauth2/redirect}
auth.server.jws256=${JWS256}
auth.server.login-page-url=${LOGIN_PAGE_URL}
auth.server.enable-lock-account=${ENABLE_LOCK_ACCOUNT:false}
auth.server.max-login-failed-cnt=${MAX_LOGIN_FAILED_CNT:5}
auth.server.introspect-token=${INTROSPECT_TOKEN:true}
auth.server.check-code-result-live=${CHECK_CODE_RESULT_LIVE:1}
auth.server.max-login-log-num=${MAX_LOGIN_LOG_NUM:30}
auth.server.update-pwd-remind-task-cron=${UPDATE_PWD_REMIND_TASK_CRON:0 */5 * * * ?}
auth.server.update-pwd-remind-task-enabled=${UPDATE_PWD_REMIND_TASK_ENABLED:false}
auth.server.remember-me-token-secret=${REMEMBER_ME_TOKEN_SECRET:auth-server-remember-me-token-secret}
auth.server.ignore-authentication-uri-list[0]=/error
auth.server.ignore-authentication-uri-list[1]=/api/v1/login
auth.server.ignore-authentication-uri-list[2]=/api/v1/login/email
auth.server.ignore-authentication-uri-list[3]=/swagger-ui/**
auth.server.ignore-authentication-uri-list[4]=/api/v1/docs/**
auth.server.ignore-authentication-uri-list[5]=/api/v1/code/email/*
auth.server.ignore-authentication-uri-list[6]=/api/v1/code/check
auth.server.ignore-authentication-uri-list[7]=/api/v1/user/me/password/reset
auth.server.ignore-authentication-uri-list[8]=/api/v1/tenant/check/*
auth.server.ignore-authentication-uri-list[9]=/api/v1/captcha/get
auth.server.ignore-authentication-uri-list[10]=/api/v1/captcha/check
auth.server.ignore-authentication-uri-list[11]=/ui/**
auth.server.ignore-authentication-uri-list[12]=/
auth.server.ignore-authentication-uri-list[13]=/api/v1/setting/passwordPolicy/checkWithoutPolicy
auth.server.ignore-authentication-uri-list[14]=/api/v1/identitySource/enabled
auth.server.ignore-authentication-uri-list[15]=/api/v1/webauthn/authenticate/options
auth.server.ignore-authentication-uri-list[16]=/api/v1/login/passkey


multi.tenant.db.driver-class-name=org.postgresql.Driver
multi.tenant.db.base-url=${DB_BASE_URL}
multi.tenant.db.username=${DB_USERNAME}
multi.tenant.db.password=${DB_PASSWORD}
multi.tenant.db-prefix=${DB_PREFIX}
multi.tenant.default-tenant=${DEFAULT_TENANT}
multi.tenant.flyway-location=classpath:flyway/postgre/tenant
multi.tenant.hikari-cp-config.connection-timeout=30000
multi.tenant.hikari-cp-config.maximum-pool-size=15
multi.tenant.hikari-cp-config.minimum-idle=5

loki.enabled=${LOKI_ENABLED:false}
loki.url=${LOKI_URL:}
loki.env=${LOKI_ENV:prod}

aj.captcha.cache-type=redis
aj.captcha.type=default
aj.captcha.water-mark=Auth Server
aj.captcha.interference-options=2

auth.client.issuer=http://127.0.0.1:${server.port}
